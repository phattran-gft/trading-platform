module Daml.Trading.Tests.BadgeTest where
import Daml.Trading.Account.Account qualified as CreateAccount
import Daml.Trading.Reward.Badge qualified as Badge
import Daml.Script

setup : Script()

setup = script do
  admin <- allocateParty "Admin"
  alice <- allocateParty "Alice"
  bob <- allocateParty "Bob"
  charlie <- allocateParty "Charlie"

  aliceCreateAccountCid <- submit admin do
    createCmd CreateAccount.Account
      with
        custodian = admin
        owner = alice
        accountType = CreateAccount.Retail 
        username = "alice" 
        realName = "Alice" 
        passportNumber = "" 
        nationalId = "333333" 
        address  = "Boston" 
        optCashAccount = None 
        optNftAccount = None 
        rewardPoints = 1600
        badges = []

  aliceRedeem1 <- submit alice do
    exerciseCmd aliceCreateAccountCid CreateAccount.Redeem_Badge with 
      redeem_badge = Badge.Novice_Trader 

  bobCreateAccountCid <- submit admin do
    createCmd CreateAccount.Account
      with
        custodian = admin
        owner = bob
        accountType = CreateAccount.Retail 
        username = "bá»b" 
        realName = "Bob" 
        passportNumber = "" 
        nationalId = "111111" 
        address  = "Boston" 
        optCashAccount = None 
        optNftAccount = None 
        rewardPoints = 120
        badges = []

  bobRedeem1 <- submit bob do
    exerciseCmd bobCreateAccountCid CreateAccount.Redeem_Badge with 
      redeem_badge = Badge.Novice_Trader 

  aliceRedeem2 <- submit alice do
    exerciseCmd aliceRedeem1 CreateAccount.Redeem_Badge with 
      redeem_badge = Badge.Pro_Trader

  submit alice do
    exerciseCmd aliceRedeem2 CreateAccount.Redeem_Badge with 
      redeem_badge = Badge.Hall_of_Fame_Trader
  pure()
